<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.financial.dao.BudgetDao">
     
       <resultMap id="BudgetMap" type="Budget">
           <id column="id" property="id" jdbcType="INTEGER" />
           <result column="oId" property="oId" jdbcType="VARCHAR" />
           <result column="info" property="info"  />
           <result column="createTime" property="createTime" jdbcType="DATE" />
           <result column="updateTime" property="updateTime" jdbcType="DATE" />
           <result column="typeId" property="typeId" jdbcType="VARCHAR" />
           <result column="uId" property="uId" jdbcType="VARCHAR" />
           <result column="year" property="year" jdbcType="INTEGER" />
           <result column="month" property="month" jdbcType="INTEGER" /> 
           <result column="status" property="status" jdbcType="INTEGER"/> 
           
          <!--  <association property="users"  resultMap="userResultMap" ></association> -->
       </resultMap> 
          
       <!--新增预算数据 -->
       <insert id="insertBudget" parameterType="Budget" keyProperty="id">
            insert into budget(id,oId,info,createTime,updateTime,typeId,uId,year,month,status)
            values (#{id},#{oId},#{info},#{createTime,jdbcType=DATE},#{updateTime,jdbcType=DATE},#{typeId},#{uId},#{year},#{month},#{status})
       </insert>
      
      
       <!-- 查询所有的预算数据 -->
       <select id="getAllBudget" resultMap="BudgetMap">  
        select * from  budget where status=1
       </select>
       
      <!--  根据id查询预算数据 -->
       <select id="selectBudgetById" parameterType="String" resultMap="BudgetMap" >
           SELECT * FROM budget WHERE id = #{id} and status=1
       </select>
       
       <!-- 根据条件查询预算数据 -->
       <select id="listBudgetBy" parameterType="map" resultType="Budget">
         SELECT * FROM budget WHERE status=1 
        <include refid="query_budget_where"></include>
       </select>
       
       <!-- 根据条件修改预算数据 -->
      <update id="updateBudget" parameterType="map">
        update budget
        <trim prefix="set" suffixOverrides=",">
            <if test=" oId!=null and oId!=''">
                oId = #{oId}
            </if>
            <if test="info!=null and info!=''">
                info = #{info}
            </if>
            <if test="createTime!=null and createTime!=''">
                createTime = #{createTime}
            </if>
            <if test="updateTime!=null and updateTime!=''">
                updateTime = #{updateTime}
            </if>
            <if test="typeId !=null and typeId!=''">
                typeId = #{typeId}
            </if>
            <if test="uId!=null and uId!=''">
                uId = #{uId}
            </if>
            <if test="year !=null and year!=''">
                year = #{year}
            </if>
            <if test="month!=null and month!=''">
                month = #{month}
            </if>
            <if test="status!=null and status!=''">
                status = #{status}
            </if>
        </trim>
        where
        id = #{id} and  status=1
      </update>
      
      <!--sql-->
     <sql id="query_budget_where">
        <if test="id!=null and id!=''">
            and id = #{id}
        </if>
        <if test=" oId!=null and oId!=''">
            oId = #{oId}
        </if>
        <if test="info!=null and info!=''">
            info = #{info}
        </if>
        <if test="createTime!=null and createTime!=''">
            createTime = #{createTime}
        </if>
        <if test="updateTime!=null and updateTime!=''">
            updateTime = #{updateTime}
        </if>
        <if test="typeId !=null and typeId!=''">
            typeId = #{typeId}
        </if>
        <if test="uId!=null and uId!=''">
            uId = #{uId}
        </if>
        <if test="year !=null and year!=''">
            year = #{year}
        </if>
        <if test="month!=null and month!=''">
            month = #{month}
         </if>
         <if test="status!=null and status!=''">
            status = #{status}
         </if>
    </sql>
    
</mapper>